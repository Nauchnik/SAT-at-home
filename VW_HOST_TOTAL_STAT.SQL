CREATE VIEW VW_HOST_TOTAL_STAT AS
SELECT
    COUNT(*) AS HOSTS_TOTAL,
    COUNT(CASE VENDOR WHEN 'AMD' THEN 1 ELSE NULL END) AS HOSTS_BASED_ON_AMD,
    COUNT(CASE VENDOR WHEN 'Centaur' THEN 1 ELSE NULL END) AS HOSTS_BASED_ON_CENTAUR,
    COUNT(CASE VENDOR WHEN 'Intel' THEN 1 ELSE NULL END) AS HOSTS_BASED_ON_INTEL,
    COUNT(CASE VENDOR WHEN 'Transmeta' THEN 1 ELSE NULL END) AS HOSTS_BASED_ON_TRANSMETA,
    COUNT(CASE VENDOR WHEN 'Unidentified' THEN 1 ELSE NULL END) AS HOSTS_OTHER,

    COUNT(CASE WHEN TOTAL_CREDIT > 0 THEN 1 ELSE NULL END) AS HOSTS_WITH_CREDIT_TOTAL,
    COUNT(CASE WHEN VENDOR = 'AMD' AND TOTAL_CREDIT > 0 THEN 1 ELSE NULL END) AS HOSTS_WITH_CREDIT_AMD,
    COUNT(CASE WHEN VENDOR = 'Centaur' AND TOTAL_CREDIT > 0 THEN 1 ELSE NULL END) AS HOSTS_WITH_CREDIT_CENTAUR,
    COUNT(CASE WHEN VENDOR = 'Intel' AND TOTAL_CREDIT > 0 THEN 1 ELSE NULL END) AS HOSTS_WITH_CREDIT_INTEL,
    COUNT(CASE WHEN VENDOR = 'Transmeta' AND TOTAL_CREDIT > 0 THEN 1 ELSE NULL END) AS HOSTS_WITH_CREDIT_TRANSMETA,
    COUNT(CASE WHEN VENDOR = 'Unidentified' AND TOTAL_CREDIT > 0 THEN 1 ELSE NULL END) AS HOSTS_WITH_CREDIT_OTHER,

    COUNT(CASE WHEN RPC_TIME + 3600*24*7 > UNIX_TIMESTAMP(NOW()) THEN 1 ELSE NULL END) AS HOSTS_ACTIVE_LAST_WEEK_TOTAL,
    COUNT(CASE WHEN VENDOR = 'AMD' AND RPC_TIME + 3600*24*7 > UNIX_TIMESTAMP(NOW()) THEN 1 ELSE NULL END) AS HOSTS_ACTIVE_LAST_WEEK_AMD,
    COUNT(CASE WHEN VENDOR = 'Centaur' AND RPC_TIME + 3600*24*7 > UNIX_TIMESTAMP(NOW()) THEN 1 ELSE NULL END) AS HOSTS_ACTIVE_LAST_WEEK_CENTAUR,
    COUNT(CASE WHEN VENDOR = 'Intel' AND RPC_TIME + 3600*24*7 > UNIX_TIMESTAMP(NOW()) THEN 1 ELSE NULL END) AS HOSTS_ACTIVE_LAST_WEEK_INTEL,
    COUNT(CASE WHEN VENDOR = 'Transmeta' AND RPC_TIME + 3600*24*7 > UNIX_TIMESTAMP(NOW()) THEN 1 ELSE NULL END) AS HOSTS_ACTIVE_LAST_WEEK_TRANSMETA,
    COUNT(CASE WHEN VENDOR = 'Unidentified' AND RPC_TIME + 3600*24*7 > UNIX_TIMESTAMP(NOW()) THEN 1 ELSE NULL END) AS HOSTS_ACTIVE_LAST_WEEK_OTHER,

    COUNT(CASE WHEN RPC_TIME + 3600*24 > UNIX_TIMESTAMP(NOW()) THEN 1 ELSE NULL END) AS HOSTS_ACTIVE_LAST_DAY_TOTAL,
    COUNT(CASE WHEN VENDOR = 'AMD' AND RPC_TIME + 3600*24 > UNIX_TIMESTAMP(NOW()) THEN 1 ELSE NULL END) AS HOSTS_ACTIVE_LAST_DAY_AMD,
    COUNT(CASE WHEN VENDOR = 'Centaur' AND RPC_TIME + 3600*24 > UNIX_TIMESTAMP(NOW()) THEN 1 ELSE NULL END) AS HOSTS_ACTIVE_LAST_DAY_CENTAUR,
    COUNT(CASE WHEN VENDOR = 'Intel' AND RPC_TIME + 3600*24 > UNIX_TIMESTAMP(NOW()) THEN 1 ELSE NULL END) AS HOSTS_ACTIVE_LAST_DAY_INTEL,
    COUNT(CASE WHEN VENDOR = 'Transmeta' AND RPC_TIME + 3600*24 > UNIX_TIMESTAMP(NOW()) THEN 1 ELSE NULL END) AS HOSTS_ACTIVE_LAST_DAY_TRANSMETA,
    COUNT(CASE WHEN VENDOR = 'Unidentified' AND RPC_TIME + 3600*24 > UNIX_TIMESTAMP(NOW()) THEN 1 ELSE NULL END) AS HOSTS_ACTIVE_LAST_DAY_OTHER,

    SUM(P_NCPUS) AS  CPU_TOTAL,
    SUM(CASE WHEN VENDOR = 'AMD' THEN P_NCPUS ELSE 0 END) AS CPU_AMD,
    SUM(CASE WHEN VENDOR = 'Centaur' THEN P_NCPUS ELSE 0 END) AS CPU_CENTAUR,
    SUM(CASE WHEN VENDOR = 'Intel' THEN P_NCPUS ELSE 0 END) AS CPU_INTEL,
    SUM(CASE WHEN VENDOR = 'Transmeta' THEN P_NCPUS ELSE 0 END) AS CPU_TRANSMETA,
    SUM(CASE WHEN VENDOR = 'Unidentified' THEN P_NCPUS ELSE 0 END) AS CPU_OTHER,

    SUM(EXPAVG_CREDIT) AS RAC_TOTAL,
    SUM(CASE WHEN VENDOR = 'AMD' THEN EXPAVG_CREDIT ELSE 0 END) AS RAC_AMD,
    SUM(CASE WHEN VENDOR = 'Centaur' THEN EXPAVG_CREDIT ELSE 0 END) AS RAC_CENTAUR,
    SUM(CASE WHEN VENDOR = 'Intel' THEN EXPAVG_CREDIT ELSE 0 END) AS RAC_INTEL,
    SUM(CASE WHEN VENDOR = 'Transmeta' THEN EXPAVG_CREDIT ELSE 0 END) AS RAC_TRANSMETA,
    SUM(CASE WHEN VENDOR = 'Unidentified' THEN EXPAVG_CREDIT ELSE 0 END) AS RAC_OTHER
  FROM VW_HOST;